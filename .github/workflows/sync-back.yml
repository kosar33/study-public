name: Sync Back to Private via PR

on:
  push:
    branches: [ main ]

jobs:
  sync-back:
    runs-on: ubuntu-latest
    # –í–ê–ñ–ù–û: –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å, –µ—Å–ª–∏ —ç—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ò–ó –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —Ä–µ–ø–æ (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ø–µ—Ç–ª–∏)
    if: "!contains(github.event.head_commit.message, 'Sync from Private Vault')"
    
    steps:
      - uses: actions/checkout@v4
      
      # 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ –≤ –ø–∞–ø–∫—É 'private-vault'
      - name: Checkout Private Repo
        uses: actions/checkout@v4
        with:
          repository: kosar33/2brain  # <-- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —Ä–µ–ø–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
          token: ${{ secrets.PRIVATE_REPO_TOKEN }}
          path: private-vault

      # 2. –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –∏–∑ Public (—Ç–µ–∫—É—â–∞—è) –≤ Private/10_Space/–£—á–µ–±–∞
      - name: Copy files back
        run: |
          # rsync —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ø–∞–ø–∫–∏. 
          # --delete —É–¥–∞–ª–∏—Ç —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –µ—Å–ª–∏ –∏—Ö —É–¥–∞–ª–∏–ª–∏ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ (–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã)
          # –ò—Å–∫–ª—é—á–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–∞–ø–∫–∏ git –∏ —Å–∞–º—É –ø–∞–ø–∫—É –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤ —Å–µ–±—è
          rsync -av --progress . private-vault/10_Space/–£—á–µ–±–∞/ --exclude .git --exclude .github --exclude private-vault --exclude README.md

      # 3. –°–æ–∑–¥–∞–µ–º Pull Request –≤ –ü—Ä–∏–≤–∞—Ç–Ω–æ–º —Ä–µ–ø–æ
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.PRIVATE_REPO_TOKEN }}
          path: private-vault
          commit-message: "Sync: Changes from Public Repo"
          committer: GitHub <noreply@github.com>
          author: ${{ github.actor }} <${{ github.actor }}@users.noreply.github.com>
          branch: contrib/sync-from-public
          delete-branch: true
          title: "üîÑ Sync: Updates from Study Public Repo"
          body: |
            –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏—à–ª–∏ –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –£—á–µ–±—ã.
            –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –ø—Ä–∏–º–∏—Ç–µ (Merge).
          base: main